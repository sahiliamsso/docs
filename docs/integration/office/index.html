<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Office 365 - Gluu Docs</title>
      
<link href="../../assets/stylesheets/font.css" rel="stylesheet">
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Gluu Docs">
    <meta property="og:image" content="None/../../gluu.jpg">
    <meta name="apple-mobile-web-app-title" content="Gluu Docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../gluu.jpg">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-60feabe0e5.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-60feabe0e5.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-f58e216493.css">
    
    <link rel="stylesheet" href="../../assets/stylesheets/zenburn-28d5b94970.css">
    
      
      
      
      <link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Sans:400,700|Source+Code+Pro">
      <style>
        body, input {
          font-family: 'Noto Sans', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Source Code Pro', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
    <script src="../../assets/javascripts/modernizr-4a5cc7e01e.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Integration Guide <i class="icon icon-link"></i>
              
            
          </span>
        
        Office 365
      </div>
    </div>
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" placeholder="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">

  
  <a href="https://github.com/GluuFederation/docs-3" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../gluu.jpg">
        </div>
      
      <div class="name">
        <strong>Gluu Docs</strong><br>
        version: 3.0.0
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      <ul class="repo">
        
        <li class="home">
          <a href="/" title="Home">
            <div class="home-image">
            <i class="fa fa-home"></i> Doc Home</div>
          </a>
        </li>
        
        
        
        <li class="repo-download">
          
          <a href="https://github.com/GluuFederation/docs-3/archive/3.0.0.zip" target="_blank" title="Download" data-action="download">
            <i class="icon icon-download"></i> Download
          </a>
        </li>
        
      </ul>
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../..">
      Home
    </a>
    
  </li>
                  
          
            
  <li>
    <span class="section">Installation Guide</span>
    <ul>
      
        
  <li>
    <a class="" title="Preparing VM" href="../../installation-guide/">
      Preparing VM
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Install Gluu Server" href="../../installation-guide/install/">
      Install Gluu Server
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Setup Script Options" href="../../installation-guide/setup_py/">
      Setup Script Options
    </a>
    
  </li>
                  
      
    </ul>
  </li>
                  
          
            
  <li>
    <span class="section">Administration Guide</span>
    <ul>
      
        
  <li>
    <a class="" title="Gluu Server UI" href="../../admin-guide/oxtrust-ui/">
      Gluu Server UI
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="SSO Protocols" href="../../admin-guide/auth-protocol/">
      SSO Protocols
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Authentication Management" href="../../admin-guide/auth-management/">
      Authentication Management
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="User Authentication" href="../../admin-guide/user-authentications/">
      User Authentication
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="User Management" href="../../admin-guide/user-group/">
      User Management
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Log Management" href="../../admin-guide/logs/">
      Log Management
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="OpenID Clients" href="../../admin-guide/clients/">
      OpenID Clients
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="SAML SSO" href="../../admin-guide/saml/">
      SAML SSO
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="OAuth2 Grants" href="../../admin-guide/oauth2/">
      OAuth2 Grants
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="OpenID Connect" href="../../admin-guide/openid-connect/">
      OpenID Connect
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="UMA" href="../../admin-guide/uma/">
      UMA
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Attribute Management" href="../../admin-guide/attribute/">
      Attribute Management
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="SCIM protected by UMA" href="../../admin-guide/scim-uma/">
      SCIM protected by UMA
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Gluu Server APIs" href="../../admin-guide/api/">
      Gluu Server APIs
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="SCIM API Configuration" href="../../admin-guide/scim/">
      SCIM API Configuration
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Backup Gluu Server CE" href="../../admin-guide/backup/">
      Backup Gluu Server CE
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Custom Script in Gluu CE" href="../../admin-guide/custom-script/">
      Custom Script in Gluu CE
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Certificate Management" href="../../admin-guide/certificate/">
      Certificate Management
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="FAQ & Troubleshooting" href="../../admin-guide/faq/">
      FAQ & Troubleshooting
    </a>
    
  </li>
                  
      
    </ul>
  </li>
                  
          
            
  <li>
    <span class="section">Integration Guide</span>
    <ul>
      
        
  <li>
    <a class="" title="SAML SP" href="../saml-sp/">
      SAML SP
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="OpenIDC RP" href="../openidc-rp/">
      OpenIDC RP
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="OXD OAuth2" href="../oauth2/">
      OXD OAuth2
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Google SSO" href="../google/">
      Google SSO
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="current" title="Office 365" href="./">
      Office 365
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Office 365 Configuration" href="#office-365-configuration">
                <b>Office 365 Configuration</b>
              </a>
            </li>
            
          
            <li class="anchor">
              <a title="Gluu Server Configuration" href="#gluu-server-configuration">
                <b>Gluu Server Configuration</b>
              </a>
            </li>
            
              <li class="anchor">
              <a title="Custom Attributes" href="#custom-attributes">
                  <font size=2><i>Custom Attributes</i></font>
              </a>
            </li>
             
              <li class="anchor">
              <a title="OpenDJ Configuration" href="#opendj-configuration">
                  <font size=2><i>OpenDJ Configuration</i></font>
              </a>
            </li>
             
              <li class="anchor">
              <a title="Identity Mapping" href="#identity-mapping">
                  <font size=2><i>Identity Mapping</i></font>
              </a>
            </li>
             
              <li class="anchor">
              <a title="Create Trust Relationship" href="#create-trust-relationship">
                  <font size=2><i>Create Trust Relationship</i></font>
              </a>
            </li>
             
          
        </ul>
      
    
  </li>
                  
      
        
  <li>
    <a class="" title="Hobsons Education Sol" href="../hobsons/">
      Hobsons Education Sol
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Salesforce" href="../salesforce/">
      Salesforce
    </a>
    
  </li>
                  
      
        
  <li>
    <a class="" title="Dropbox" href="../dropbox/">
      Dropbox
    </a>
    
  </li>
                  
      
    </ul>
  </li>
                  
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="office-365-integration-with-gluu-server">Office 365 Integration with Gluu Server<a class="headerlink" href="#office-365-integration-with-gluu-server" title="Permanent link">#</a></h1>
<p>This guide is created to use Microsoft Office 365 Single-Sign-On with Gluu Server.
It is assumed that an Office 365 subscription is available/registered.</p>
<p><strong>Note:</strong> The attributes <code>ObjectGUID</code> and <code>IDPEmail</code> are mandatory for O365 SSO. The domain of <code>IDPEmail</code> must match the registered domain as well.</p>
<h2 id="office-365-configuration">Office 365 Configuration<a class="headerlink" href="#office-365-configuration" title="Permanent link">#</a></h2>
<ol>
<li>
<p>Please create a test user from Office365 Admin Panel<br/>
   Alternatively, use <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-aadconnect/">this doc</a> to connect backend Azure Active Directory (AD) </p>
</li>
<li>
<p>Register the domain from the Office365 (O365) Admin Panel from <strong>Settings --&gt; Domains</strong></p>
<ul>
<li><em>Verify</em> the domain</li>
</ul>
</li>
<li>
<p>Register Gluu Server in O365</p>
<ul>
<li>
<p>Install/Use Windows Server 2012 R2</p>
</li>
<li>
<p><a href="https://technet.microsoft.com/en-us/library/jj205464">Install and Configure</a> Windows Powershell <em>cmdlets</em></p>
</li>
<li>
<p>Create a script named <code>gluu1.ps1</code> with the following template changing domain, hostname of Gluu Server and Certificate</p>
</li>
</ul>
</li>
</ol>
<pre><code> Connect-MsolService

$dom = &quot;company.org&quot;
$url = &quot;https://test.gluu.org/idp/profile/SAML2/POST/SSO&quot;
$uri = &quot;https://test.gluu.org/idp/shibboleth&quot;
$logouturl = &quot;https://test.gluu.org/idp/logout.jsp&quot;
$cert = &quot;Mx....SAML_cert_of_your_Gluu_Server...Tdsg9R0XO3AnBeHRtGmAA=&quot;

Set-MsolDomainAuthentication -DomainName $dom -FederationBrandName $dom -Authentication Federated  -PassiveLogOnUri $url -SigningCertificate $cert -IssuerUri $uri -LogOffUri $logouturl -PreferredAuthenticationProtocol SAMLP 
</code></pre>

<ol>
<li>Run the <code>gluu.ps1</code> script from Windows Server 2012 R2</li>
</ol>
<h2 id="gluu-server-configuration">Gluu Server Configuration<a class="headerlink" href="#gluu-server-configuration" title="Permanent link">#</a></h2>
<h3 id="custom-attributes">Custom Attributes<a class="headerlink" href="#custom-attributes" title="Permanent link">#</a></h3>
<p>The configuration begins by creating a few custom attributes named <code>IDPEmail</code>, <code>ImmutableID</code> and <code>objectguid</code>.
Please see <a href="../../admin-guide/attribute/">this doc</a> to create custom attributes.</p>
<ol>
<li>
<p><code>IDPEmail</code> Custom Attribute
<img alt="image" src="../../img/integration/idpemail.png" /></p>
</li>
<li>
<p><code>ImmutableID</code> Custom Attribute
<img alt="image" src="../../img/integration/immutableid.png" /></p>
</li>
<li>
<p><code>objectguid</code> Custom Attribute
<img alt="image" src="../../img/integration/objectguid.png" /></p>
</li>
</ol>
<h3 id="opendj-configuration">OpenDJ Configuration<a class="headerlink" href="#opendj-configuration" title="Permanent link">#</a></h3>
<ol>
<li>
<p>Edit the <code>100-user.ldif</code> file under <code>/opt/opendj/config/schema</code> folder.</p>
<ul>
<li>
<p>Remove the <code>obhectGUID</code> entry from the file</p>
</li>
<li>
<p>Add the following new entry</p>
</li>
</ul>
</li>
</ol>
<pre><code>attributeTypes: ( 1454676848732 NAME 'objectGUID' SYNTAX 1.3.6.1.4.1.1466.115.121.1.5 USAGE userApplications X-ORIGIN 'gluu' ) 
</code></pre>

<pre><code>* Restart OpenDJ
</code></pre>
<ol>
<li>
<p>Edit the <code>attribute-resolver.xml.vm</code> file under <code>/opt/tomcat/conf/shibboleth2/idp</code> folder</p>
<ul>
<li>Add <code>$attribute.name.equals('ImmutableID')</code> with the existing <em>($attribute.name.equals('transientId')</em> to look like the snippet below</li>
</ul>
</li>
</ol>
<pre><code>#if(!($attribute.name.equals('transientId')or$attribute.name.equals('ImmutableID'))) 
</code></pre>

<pre><code>* Add `IDPEmail` attribute definition
</code></pre>
<pre><code> &lt;resolver:AttributeDefinition xsi:type=&quot;ad:Simple&quot; id=&quot;UserId&quot; sourceAttributeID=&quot;IDPEmail&quot;&gt;
                        &lt;resolver:Dependency ref=&quot;siteLDAP&quot; /&gt;
                        &lt;resolver:AttributeEncoder xsi:type=&quot;enc:SAML2String&quot; name=&quot;IDPEmail&quot; friendlyName=&quot;UserId&quot; /&gt;
        &lt;/resolver:AttributeDefinition&gt; 
</code></pre>

<pre><code>* Add `ImmutableID` attribute definition
</code></pre>
<pre><code> &lt;resolver:AttributeDefinition id=&quot;ImmutableID&quot; xsi:type=&quot;Simple&quot;
                              xmlns=&quot;urn:mace:shibboleth:2.0:resolver:ad&quot;
                              sourceAttributeID=&quot;objectguid&quot;&gt;

        &lt;resolver:Dependency ref=&quot;siteLDAP&quot;/&gt;
        &lt;resolver:AttributeEncoder xsi:type=&quot;SAML2StringNameID&quot;
                                xmlns=&quot;urn:mace:shibboleth:2.0:attribute:encoder&quot;
                                nameFormat=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot; /&gt;
&lt;/resolver:AttributeDefinition&gt; 
</code></pre>

<h3 id="identity-mapping">Identity Mapping<a class="headerlink" href="#identity-mapping" title="Permanent link">#</a></h3>
<p>The cache refresh mechanism is used to populate the Gluu Server LDAP with data from a backend LDAP/AD. The <code>objectGUID</code> attribute must be pulled from the backend data source to Gluu Server.</p>
<ul>
<li>Edit the <code>ox-ldap.properties</code>, <code>oxauth-ldap.properties</code> and <code>oxidp-ldap.properties</code> files to add the following</li>
</ul>
<pre><code>binaryAttributes=objectGUID,objectguid 
</code></pre>

<p><strong>Note:</strong>'objectGUID' (the first one) is the attribute which contains binary values in the backend AD and 'objectguid' (the second one) is the Gluu Server binary attribute name which will pull value from 'objectGUID' attribute</p>
<ul>
<li>Restart Tomcat</li>
</ul>
<h3 id="create-trust-relationship">Create Trust Relationship<a class="headerlink" href="#create-trust-relationship" title="Permanent link">#</a></h3>
<p>Please see <a href="../../admin-guide/saml/">this doc</a> to create trust relationships.</p>
<ul>
<li>Configure Relaying Party like the following screenshot
<img alt="image" src="../../img/integration/o365_trelationship.png" /></li>
</ul>
          <aside class="copyright" role="note">
           Built with 
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a> using
            <a href="http://gitlab.testbird.io:8099/frontend/testbird-mkdocs-theme.git" target="_blank">
              testBird-mkdocs-theme
            </a> <br>
            
            Copyright &copy; 2016, Gluu, Inc.
            
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../google/" title="Google SSO">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Google SSO
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../hobsons/" title="Hobsons Education Sol">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Hobsons Education Sol
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = '';
    </script>
    <script src="../../assets/javascripts/application-ce3999cf34.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    
  </body>
</html>